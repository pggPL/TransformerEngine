<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 580" width="850" height="580">
  <defs>
    <style>
      @import url("diagram-colors.css");
      /* Diagram-specific overrides */
      .hp { fill: #f3e5f5; stroke: #7b1fa2; stroke-width: 2.5; }
      .gemm { fill: #ffe8cc; stroke: #f57c00; stroke-width: 3; }
      .quantize { fill: #c8e6c9; stroke: #43a047; stroke-width: 2.5; }
      .text { font-weight: 500; }
      .small-text { fill: #616161; }
      .title { font-weight: 700; fill: #1a1a1a; }
      .arrow { stroke: #424242; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="6" markerHeight="6" refX="5" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#424242" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="425" y="30" class="title">LayerNorm + Linear: Separate vs Fused</text>
  
  <!-- Divider Line -->
  <line x1="425" y1="50" x2="425" y2="570" stroke="#bdbdbd" stroke-width="2.5" stroke-dasharray="5,5"/>
  
  <!-- LEFT: Separate Layers -->
  <text x="212" y="65" class="section-title">Scenario 1: Separate Layers</text>
  
  <!-- Input -->
  <rect x="137" y="95" width="150" height="55" class="hp" rx="8"/>
  <text x="212" y="128" class="text">Input</text>
  
  <!-- Arrow -->
  <path d="M 212 150 L 212 180" class="arrow"/>
  
  <!-- LayerNorm -->
  <rect x="137" y="180" width="150" height="55" class="layernorm" rx="8"/>
  <text x="212" y="213" class="text" style="font-weight: 600;">LayerNorm</text>
  
  <!-- Arrow -->
  <path d="M 212 235 L 212 260" class="arrow"/>
  
  <!-- Output FP32 -->
  <rect x="147" y="260" width="130" height="50" class="hp" rx="8"/>
  <text x="212" y="290" class="text">Output</text>
  
  <!-- Arrow -->
  <path d="M 212 310 L 212 330" class="arrow"/>
  
  <!-- Linear wrapper -->
  <rect x="122" y="330" width="180" height="150" class="gemm" rx="10"/>
  <text x="212" y="358" class="text" style="font-weight: 600;">Linear</text>
  
  <!-- Quantize inside -->
  <rect x="142" y="375" width="140" height="40" class="quantize" rx="8"/>
  <text x="212" y="399" class="text">Quantize</text>
  
  <!-- Arrow -->
  <path d="M 212 415 L 212 428" style="stroke: #424242; stroke-width: 2; fill: none;"/>
  
  <!-- Simplified computation inside -->
  <rect x="142" y="428" width="140" height="40" class="computation" rx="8"/>
  <text x="212" y="453" class="title" style="font-weight: 600;">...</text>
  
  <!-- Arrow -->
  <path d="M 212 468 L 212 475" style="stroke: #424242; stroke-width: 2; fill: none;"/>
  
  <!-- Arrow out of Linear -->
  <path d="M 212 480 L 212 500" class="arrow"/>
  
  <!-- Output -->
  <rect x="137" y="500" width="150" height="55" class="hp" rx="8"/>
  <text x="212" y="533" class="text">Output</text>
  
  
  <!-- RIGHT: Fused Layer -->
  <text x="637" y="65" class="section-title">Scenario 2: Fused Layer</text>
  
  <!-- Input -->
  <rect x="562" y="95" width="150" height="55" class="hp" rx="8"/>
  <text x="637" y="128" class="text">Input</text>
  
  <!-- Arrow -->
  <path d="M 637 150 L 637 185" class="arrow"/>
  
  <!-- LayerNormLinear Fused -->
  <rect x="517" y="185" width="240" height="190" class="fused" rx="10"/>
  <text x="637" y="212" class="text" style="font-weight: 600;">LayerNormLinear</text>
  
  <!-- Inside fused block -->
  <!-- LayerNorm -->
  <rect x="537" y="235" width="200" height="50" class="layernorm" rx="8"/>
  <text x="637" y="265" class="text">LayerNorm + Quantize</text>
  
  <!-- Arrow -->
  <path d="M 637 285 L 637 300" style="stroke: #424242; stroke-width: 2; fill: none;"/>
  
  <!-- Simplified computation -->
  <rect x="567" y="300" width="140" height="60" class="computation" rx="8"/>
  <text x="637" y="335" class="title" style="font-weight: 600;">...</text>
  
  <!-- Arrow -->
  <path d="M 637 360 L 637 370" style="stroke: #424242; stroke-width: 2; fill: none;"/>
  
  <!-- Arrow out of fused block -->
  <path d="M 637 375 L 637 500" class="arrow"/>
  
  <!-- Output -->
  <rect x="562" y="500" width="150" height="55" class="hp" rx="8"/>
  <text x="637" y="533" class="text">Output</text>
  
</svg>
